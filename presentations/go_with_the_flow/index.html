<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Go with the flow</title><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><link rel="stylesheet" href="pv.css" media="screen,projection"></link></head><body class="impress-not-supported"><div id="impress"><div class="step step-level-1" step="0" id="intro_image" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="0" data-z="0"><img src="title_template.png" width="800"></img></div><div class="step step-level-1" step="1" id="inspect_and_adapt" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="1600" data-y="0" data-z="0"><p><em>inspect</em> and <strong>adapt</strong></p></div><div class="step step-level-1" step="2" id="software" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="3200" data-y="0" data-z="0"><h1 id="software">Software...</h1><p>is <em>integral</em></p></div><div class="step step-level-1" step="3" id="abstraction" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="4800" data-y="0" data-z="0"><h1 id="abstraction">Abstraction</h1></div><div class="step step-level-1" step="4" id="reuse1" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="6400" data-y="0" data-z="0"><h1 id="reuse">Reuse</h1><p>... third party</p></div><div class="step step-level-1" step="5" id="thirdparty" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="8000" data-y="0" data-z="0"><img src="logos.png" width="800"></img></div><div class="step step-level-1" step="6" id="reuse2" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="9600" data-y="0" data-z="0"><h1 id="id1">Reuse</h1><p>... internally</p></div><div class="step step-level-1" step="7" id="hardwareregs" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="11200" data-y="0" data-z="0"><pre class="highlight code c"><span class="n">write_address</span> <span class="o">&lt;=</span> <span class="mi">16</span><span class="err">'</span><span class="n">h00A0</span><span class="p">;</span> <span class="c1">// enable register
</span><span class="n">write_data</span>    <span class="o">&lt;=</span> <span class="mi">1</span><span class="err">'</span><span class="n">b0</span><span class="p">;</span>
<span class="n">write_enable</span>  <span class="o">&lt;=</span> <span class="mi">1</span><span class="err">'</span><span class="n">b1</span><span class="p">;</span>
<span class="cp">#20 write_enable  &lt;= 1'b0;</span></pre></div><div class="step step-level-1" step="8" id="verifregs" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="12800" data-y="0" data-z="0"><pre class="highlight code c"><span class="n">ENA</span> <span class="o">=</span> <span class="n">uvm_reg_field</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">"ENA"</span><span class="p">);</span>
<span class="n">ENA</span><span class="p">.</span><span class="n">configure</span> <span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"RW"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="err">'</span><span class="n">h0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="n">uvm_reg</span> <span class="n">my_reg</span><span class="p">;</span>
<span class="n">m_regmodel</span><span class="p">.</span><span class="n">get_reg_by_name</span><span class="p">(</span><span class="s">"ENA"</span><span class="p">);</span>
<span class="n">my_reg</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="p">.</span><span class="n">parent</span><span class="p">(</span><span class="n">this</span><span class="p">));</span></pre></div><div class="step step-level-1" step="9" id="softwareregs" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="14400" data-y="0" data-z="0"><pre class="highlight code c"><span class="kt">void</span> <span class="nf">enable</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">IORD</span><span class="p">(</span><span class="n">ENABLE_BASE</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span>
    <span class="n">IOWR</span><span class="p">(</span><span class="n">ENABLE_BASE</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">);</span>
<span class="p">}</span></pre></div><div class="step step-level-1" step="10" id="answer" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="16000" data-y="0" data-z="0"><h1 id="python-makes-this-easy">Python makes this easy</h1><ul><li>SWIG</li><li>ctypes</li><li>Boost.Python</li></ul></div><div class="step step-level-1" step="11" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="17600" data-y="0" data-z="0"><h1 id="c">C++</h1><pre class="highlight code c"><span class="kt">void</span> <span class="n">ExampleHal</span><span class="o">::</span><span class="n">enable</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_reg</span><span class="o">-&gt;</span><span class="n">control</span><span class="p">.</span><span class="n">enable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span></pre></div><div class="step step-level-1" step="12" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="19200" data-y="0" data-z="0"><h1 id="testbench">Testbench</h1><pre class="highlight code python"><span class="kn">from</span> <span class="nn">xactly.simulation</span> <span class="kn">import</span> <span class="n">load_hal</span>
<span class="kn">import</span> <span class="nn">build.software.pyexample</span> <span class="kn">as</span> <span class="nn">regs</span>

<span class="c"># Auto-discover the HAL</span>
<span class="n">hal</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">load_hal</span><span class="p">(</span><span class="n">regs</span><span class="o">.</span><span class="n">ExampleRegisters</span><span class="p">,</span> <span class="n">tb</span><span class="o">.</span><span class="n">mm_master</span><span class="p">)</span>

<span class="c"># Call into C++ to control the design</span>
<span class="k">yield</span> <span class="n">hal</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span></pre></div><div class="step step-level-1" step="13" id="integration" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="20800" data-y="0" data-z="0"><h1 id="integration">integration</h1></div><div class="step step-level-1" step="14" id="communication" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="22400" data-y="0" data-z="0"><h1 id="communication">communication</h1></div><div class="step step-level-1" step="15" id="documentation" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="24000" data-y="0" data-z="0"><h1 id="documentation">documentation</h1><ul><li>accurate</li><li>accessible</li><li>concise</li><li>coherent</li></ul></div><div class="step step-level-1" step="16" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="25600" data-y="0" data-z="0"><h1 id="id2">abstraction</h1><ul><li>Avalon-MM vs AXI-4 vs Wishbone</li><li>Resets<ul><li>synchronous vs asynchronous</li><li>active low vs active high</li></ul></li><li>Register access</li></ul></div><div class="step step-level-1" step="17" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="27200" data-y="0" data-z="0"><pre class="highlight code c"><span class="n">IOWR32</span><span class="p">(</span><span class="n">MAC_ADDRESS_LOW</span><span class="p">,</span>  <span class="n">mac_address</span><span class="p">[</span><span class="mi">31</span><span class="o">:</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">IOWR32</span><span class="p">(</span><span class="n">MAC_ADDRESS_HIGH</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">47</span><span class="o">:</span><span class="mi">32</span><span class="p">]);</span></pre></div><div class="step step-level-1" step="18" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="28800" data-y="0" data-z="0"><pre class="highlight code c"><span class="n">IOWR8</span><span class="p">(</span><span class="n">MAC_ADDRESS_0</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">IOWR8</span><span class="p">(</span><span class="n">MAC_ADDRESS_1</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">15</span><span class="o">:</span><span class="mi">8</span><span class="p">]);</span>
<span class="n">IOWR8</span><span class="p">(</span><span class="n">MAC_ADDRESS_2</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">23</span><span class="o">:</span><span class="mi">16</span><span class="p">]);</span>
<span class="n">IOWR8</span><span class="p">(</span><span class="n">MAC_ADDRESS_3</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">31</span><span class="o">:</span><span class="mi">24</span><span class="p">]);</span>
<span class="n">IOWR8</span><span class="p">(</span><span class="n">MAC_ADDRESS_4</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">39</span><span class="o">:</span><span class="mi">32</span><span class="p">]);</span>
<span class="n">IOWR8</span><span class="p">(</span><span class="n">MAC_ADDRESS_5</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">47</span><span class="o">:</span><span class="mi">40</span><span class="p">]);</span></pre></div><div class="step step-level-1" step="19" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="30400" data-y="0" data-z="0"><img src="boring_registers.png" width="800"></img></div><div class="step step-level-1" step="20" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="32000" data-y="0" data-z="0"><pre class="highlight code c"><span class="n">m_regs</span><span class="o">-&gt;</span><span class="n">control</span><span class="p">.</span><span class="n">mac_address</span> <span class="o">=</span> <span class="mh">0x902c374a30f4</span><span class="p">;</span></pre></div><div class="step step-level-1" step="21" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="33600" data-y="0" data-z="0"><img src="go_with_the_flow.svg" width="800"></img></div><div class="step step-level-1" step="22" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="35200" data-y="0" data-z="0"><h1 id="the-demo">the demo...</h1></div><div class="step step-level-1" step="23" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="36800" data-y="0" data-z="0"><h1 id="recap">recap</h1></div><div class="step step-level-1" step="24" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="38400" data-y="0" data-z="0"><h1 id="automation">automation</h1><ul><li>Cookiecutter</li><li>Jenkins -&gt; Jenkins job</li><li>Jenkins job<ul><li>Simulation regression</li><li>Datasheet<ul><li>Waveform diagrams from simulation</li><li>Doxygen from C++</li><li>Register definitions</li></ul></li><li>Block-level synthesis</li></ul></li></ul></div><div class="step step-level-1" step="25" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="40000" data-y="0" data-z="0"><h1 id="visibility">visibility</h1><ul><li>Coverage data from Riviera</li><li>C++ coverage from gcov</li><li>Build times</li><li>Resource usage in hardware</li><li>Warnings from the tools</li></ul></div><div class="step step-level-1" step="26" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="41600" data-y="0" data-z="0"><h1 id="id3">integration</h1><ul><li>C++ HAL developed in simulation</li><li>"free" socket-based testbench</li><li>Debug tools for HW/sim</li></ul></div><div class="step step-level-1" step="27" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="43200" data-y="0" data-z="0"><h1 id="wrapping-up">wrapping up...</h1></div><div class="step step-level-1" step="28" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="44800" data-y="0" data-z="0"><h1 id="thank-you">thank you</h1><p><a href="http://potential.ventures">http://potential.ventures</a></p></div></div><div id="hovercraft-help"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Right, Down, Page Down</th><td>Next slide</td></tr><tr><th>Left, Up, Page Up</th><td>Previous slide</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>